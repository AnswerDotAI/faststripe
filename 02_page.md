

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

This notebook implements pagination for the Stripe API.

``` python
sapi = StripeApi(os.environ['STRIPE_SECRET_KEY'])
```

``` python
sapi.customers.get
```

[customers.get](https://docs.stripe.com/api/customers/list)(created:
‘str’, email: ‘str’, ending_before: ‘str’, expand: ‘str’, limit: ‘str’,
starting_after: ‘str’, test_clock: ‘str’): *List all customers*

``` python
customers = sapi.customers.get(limit = 1)
customers.keys(), customers.data[0].keys()
```

    (dict_keys(['object', 'data', 'has_more', 'url']),
     dict_keys(['id', 'object', 'address', 'balance', 'created', 'currency', 'default_source', 'delinquent', 'description', 'discount', 'email', 'invoice_prefix', 'invoice_settings', 'livemode', 'metadata', 'name', 'next_invoice_sequence', 'phone', 'preferred_locales', 'shipping', 'tax_exempt', 'test_clock']))

The [`paged`](https://AnswerDotAI.github.io/faststripe/page.html#paged)
function provides an iterator that automatically handles pagination for
Stripe API list methods.

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/faststripe/blob/main/faststripe/page.py#L11"
target="_blank" style="float:right; font-size:smaller">source</a>

### paged

>  paged (oper, *args, **kwargs)

*Iterate through all pages of a Stripe API operation.*

``` python
ps = L(itertools.islice(paged(sapi.customers.get, limit=2), 2))
cs = L(c for p in ps for c in p.data)
test_eq(len(ps), 2)
test_eq(len(cs), 4)
```

The [`pages`](https://AnswerDotAI.github.io/faststripe/page.html#pages)
function retrieves all items from all pages and returns them as a single
list.

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/faststripe/blob/main/faststripe/page.py#L21"
target="_blank" style="float:right; font-size:smaller">source</a>

### pages

>  pages (oper, *args, **kwargs)

*Retrieve all items from all pages of a Stripe API operation.*

Let’s test the pagination with the `customers` endpoint.

``` python
customers = pages(sapi.customers.get, limit=100)
len(customers), customers[0].keys()
```

    (1060,
     dict_keys(['id', 'object', 'address', 'balance', 'created', 'currency', 'default_source', 'delinquent', 'description', 'discount', 'email', 'invoice_prefix', 'invoice_settings', 'livemode', 'metadata', 'name', 'next_invoice_sequence', 'phone', 'preferred_locales', 'shipping', 'tax_exempt', 'test_clock']))
